

<!DOCTYPE html>
<html>
<head>
    <meta http-equiv='Pragma' CONTENT='no-cache'>
    <meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE"/>
    <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
    <link rel="stylesheet" href='te_pc_style.css' type='text/css'>
    <link rel="stylesheet" href='te_mobile_style.css' type='text/css'>
    <link rel="stylesheet" href="sweetalert.css" type="text/css">
    <script language="javascript" src="/js/te_util.js?r=9194"></script>
    <script language="javascript" src="/js/jquery.min.js?r=9194"></script>
    <script language="javascript" src="/js/jquery.qrcode.min.js?r=9194"></script>
    <!--<script language="javascript" src="/js/sweetalert.min.js?r=9194"></script>-->
    <script language="JavaScript">
    <!-- hide
    var oldIE = (navigator.userAgent.indexOf("MSIE") != -1) && (document.documentMode <= 9);
    var head = document.getElementsByTagName('head')[0];
    var js = document.createElement("script");
    js.type = "text/javascript";
    if (!oldIE) {
        js.src = '/js/sweetalert.min.js';
        head.appendChild(js);
    }

    var ismobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    var sessionKey = '2111938466';
    var curWebPage = '/te_wifi.asp';
    var syncNvram = '0';
    var unitNum = '0';
    var wifiRefresh = '0';

    var ssid_id = '0';
var acc_pt_id = '0';
var wifiSSIDName = htmlDecode('MOVISTAR_0F00');
var wifiActive = '1';
var wifiHideSSID = '0';
var channel = '0';
var wifiCurrentChannel = '1';
var band = '1';
var nbwcap = '1';
var nctrlsb = '0';
var phytype = '14';
var wifiAuthMode = '34';
var wpaPskKey = htmlDecode('PkeMUisbabEqNkUqBDgv');
var keyIdx = '1';
var keys = new Array( "1234567890123", "1234567890123", "1234567890123", "1234567890123" );
var active = '0';

    var wifiMacFlt = '';

    /* SMARTWIFI SONIQ start */
    var rmEnable = '1';
    var rmRole = '1';
    /* SMARTWIFI SONIQ end */

    var phy = parseInt(phytype);
    var wifiPassword = '';
    var MAX_MAC_FLT = 28;

    if (wifiAuthMode == '02') {
        wifiPassword = keys[keyIdx - 1];
    } else {
        wifiPassword = wpaPskKey;
    }

    if (wifiRefresh == '1') {
        var code = 'location="/cgi-bin/te_wifirefresh.wl?wlRefresh=0"';
        eval(code);
    }

    $(function() {
        if (ismobile) {
            $("#PCformat").remove();
            showtable("ActiveMAC1");
        } else {
            $("#mobileformat").remove();
            showtable("ActiveMAC");
        }
        $(".content,.Mcontent").after("<br>");
        $('#mobileformat').find('input[type!=radio],select').parent().not('td,tr').css('text-align', 'center');
        //include header
        $('#includeHeader').load("te_header.asp");
        $('[name=SSIDName],[name=SSIDName1]').val(wifiSSIDName);
        $('[name=hideSSID][value=' + wifiHideSSID + '],[name=hideSSID1][value=' + wifiHideSSID + ']').click();
        $('[name=wifiActive][value=' + wifiActive + '],[name=wifiActive1][value=' + wifiActive + ']').click();
        $('[name=AuthType]>option[value=' + wifiAuthMode + '],[name=AuthType1]>option[value=' + wifiAuthMode + ']').prop('selected', true);
        if (wifiAuthMode == '00')
            $('.pwdfield').hide();
        else {
            /* SMARTWIFI SONIQ start */
            if ((parseInt(rmRole) == 1) && (parseInt(rmEnable) == 1))
                if ((wifiAuthMode=='02') || (wifiAuthMode=='44'))
                    alertSpecial('Roaming WiFi est&#224 deshabilitado debido a su configuraci&#243n de Seguridad en WiFi. Para que Roaming se active debe configurar los modos WPA2 o Open');
            /* SMARTWIFI SONIQ end */
            $('#SSIDPassword,#SSIDPassword1').val(wifiPassword);
            var checkpass = checkPassLevel(wifiAuthMode, wifiPassword);
            showPassLevel(checkpass);
        }
        loadChannelList();
        $('[name=currentChannel],[name=currentChannel1]').html(wifiCurrentChannel);
        if (active == '0')
            $('.active').prop('src', 'te_off.png');
        else if (active == '1')
            $('.active').prop('src', 'te_on.png');

        $('[name=SSIDName],[name=SSIDName1]').on('change keyup paste mouseup', function() {
            var ssid = $('[name=SSIDName],[name=SSIDName1]').val();
            if (getSSIDLength(ssid) > 32) {
                alertSpecial("La longitud supera 32 bytes! SSID se trunca!");
                while (getSSIDLength(ssid) > 32)
                    ssid = ssid.substring(0, ssid.length - 1);
                $('[name=SSIDName],[name=SSIDName1]').val(ssid);
                $('[name=SSIDName],[name=SSIDName1]').select().focus();
            }
        });
        $('#SSIDPassword,#SSIDPassword1').on('change keyup paste mouseup', function() {
            var passlevel = checkPassLevel($('[name=AuthType],[name=AuthType1]').val(), $(this).val());
            showPassLevel(passlevel);
        });
        $('[name=AuthType],[name=AuthType1]').change(function() {
            if ($(this).val() == '00') {
                $('.pwdfield').hide();
            } else {
                $('.pwdfield').show();
                /* SMARTWIFI SONIQ start */
                if ((parseInt(rmRole) == 1) && (parseInt(rmEnable) == 1))
                    if (($(this).val() == '02') || ($(this).val() == '44'))
                        alertSpecial('Roaming WiFi est&#224 deshabilitado debido a su configuraci&#243n de Seguridad en WiFi. Para que Roaming se active debe configurar los modos WPA2 o Open');
                /* SMARTWIFI SONIQ end */
                if ($(this).val() == '02') {
                    alertSpecial('Recuerda que puedes introducir 13 caracteres en codificaci&oacute;n ASCII (letras, n&uacute;meros y caracteres especiales) o bien 26 caracteres en codificaci&oacute;n Hexadecimal (0-9 y A-F).');
                    wifiPassword = keys[keyIdx - 1];
                } else {
                    wifiPassword = wpaPskKey;
                }
                $('#SSIDPassword,#SSIDPassword1').val(wifiPassword);
                var passlevel = checkPassLevel($(this).val(), $('#SSIDPassword,#SSIDPassword1').val());
                showPassLevel(passlevel);
            }
        });
        var encodedSSID = wifiSSIDName.replace(/\\/g, '\\\\').replace(/;/g, '\\;').replace(/,/g, '\\,').replace(/:/g, '\\:').replace(/'/g, '\\\'').replace(/"/g, '\\"').replace(/\./g, '\\\.');
        var encodedPSK = wifiPassword.replace(/\\/g, '\\\\').replace(/;/g, '\\;').replace(/,/g, '\\,').replace(/:/g, '\\:').replace(/'/g, '\\\'').replace(/"/g, '\\"').replace(/\./g, '\\\.');
        var str;
        if (wifiAuthMode == '34' || wifiAuthMode == '44') {
            str = 'WIFI:T:WPA;S:' + encodedSSID + ';P:' + encodedPSK + ';';
        } else if (wifiAuthMode == '02') {
            str = 'WIFI:T:WEP;S:' + encodedSSID + ';P:' + encodedPSK + ';';
        } else {
            str = 'WIFI:T:nopass;S:' + encodedSSID + ';P:' + encodedPSK + ';';
        }
        str += ($('[name=hideSSID]:checked,[name=hideSSID1]:checked').val() == '1') ? 'H:true;' : ';';
        str = utf16to8(str);
        var str1 = str;
        var Sys = {};
        var ua = navigator.userAgent.toLowerCase();
        if (window.ActiveXObject)
            Sys.ie = ua.match(/msie ([\d.]+)/)[1];
        if (Sys.ie === '7.0' || Sys.ie === '8.0' || Sys.ie === '9.0' || Sys.ie === '10.0') {
            if (ismobile) {
                $('.code').qrcode({
                    render: "table",
                    width: 111,
                    height: 111,
                    text: str1
                });
            } else {
                $('.code').qrcode({
                    render: "table",
                    width: 111,
                    height: 111,
                    text: str
                });
            }
        } else {
            if (ismobile) {
                $('.code').qrcode({
                    width: 111,
                    height: 111,
                    text: str1
                });
            } else {
                $('.code').qrcode({
                    width: 111,
                    height: 111,
                    text: str
                });
            }
        }
        $('.code').find('td').css({
            'width': '0px',
            'height': '0px'
        });
        $('[src="show.gif"]').click(function() {
            var password = $('#SSIDPassword,#SSIDPassword1').val();
            if ($('#SSIDPassword[type=password]').length || $('#SSIDPassword1[type=password]').length) {
                $(this).prev('input').remove();
                if (ismobile)
                    $(this).before('<input class="Input_box" type="text" id="SSIDPassword1" readOnly onmouseover="passwordFocus(this)" onfocus="passwordFocus(this)" onblur="passwordBlur(this)">');
                else
                    $(this).before('<input class="Input_box" type="text" id="SSIDPassword" readOnly onmouseover="passwordFocus(this)" onfocus="passwordFocus(this)" onblur="passwordBlur(this)" size="32">');
            } else {
                $(this).prev('input').remove();
                if (ismobile)
                    $(this).before('<input class="Input_box" type="password" id="SSIDPassword1" readOnly onmouseover="passwordFocus(this)" onfocus="passwordFocus(this)" onblur="passwordBlur(this)">');
                else
                    $(this).before('<input class="Input_box" type="password" id="SSIDPassword" readOnly onmouseover="passwordFocus(this)" onfocus="passwordFocus(this)" onblur="passwordBlur(this)" size="32">');
            }

            $('#SSIDPassword,#SSIDPassword1').val(password);
            $('#SSIDPassword,#SSIDPassword1').on('change keyup paste mouseup', function() {
                var passlevel = checkPassLevel($('[name=AuthType],[name=AuthType1]').val(), $(this).val());
                showPassLevel(passlevel);
            });
        });
        $('[value="Aplicar cambios"]').on('click touchstart', function() {
            var loc = '/cgi-bin/te_wifi.wl?wlSsidIdx=0' + '&ssid_id=' + ssid_id + '&acc_pt_id=' + acc_pt_id;
            if (ismobile) {
                if (!checkSSIDValid($('[name=SSIDName1]').val()))
                    return false;
            } else {
                if (!checkSSIDValid($('[name=SSIDName]').val()))
                    return false;
            }
            loc += '&wlSsid=' + encodeURIComponent($('[name=SSIDName],[name=SSIDName1]').val());
            var hideSSID = $('[name=hideSSID]:checked,[name=hideSSID1]:checked').val();
            if (hideSSID != wifiHideSSID) {
                if (hideSSID == '1') {
                    if (confirmSpecial('Al ocultar el SSID, la funcionalidad WPS quedar&aacute; desactivada en tu router') == false)
                        return false;
                } else {
                    if (confirmSpecial('Al hacer visible el SSID, la funcionalidad WPS quedar&aacute; activada en tu router') == false)
                        return false;
                }
            }
            loc += '&wlHide=' + hideSSID;
            loc += '&wlAuthMode=' + $('[name=AuthType],[name=AuthType1]').val();
            if ($('[name=AuthType],[name=AuthType1]').val() == '00') {} else if ($('[name=AuthType],[name=AuthType1]').val() == '02') {
                var ssidpwd = $('#SSIDPassword,#SSIDPassword1').val();
                if (ssidpwd.length != 13 && ssidpwd.length != 26) {
                    alertSpecial("Longitud de clave incorrecta. Recuerda que puedes introducir 13 caracteres en codificaci&oacute;n ASCII (letras, n&uacutemeros y caracteres especiales) o bien 26 caracteres en codificaci&oacute;n Hexadecimal (0-9 y A-F).");
                    $('#SSIDPassword,#SSIDPassword1').select().focus();
                    return false;
                }

                if (confirmSpecial('Aviso: Los modos de seguridad WiFi WEP o mixto WPA/WPA2 no son seguros, le recomendamos utilizar WPA2. Además, si cambias los modos de seguridad en 2.4GHz a mixto WPA/WPA2 o WEP, la WiFi no tendrá la selección automática de tu mejor red WiFi disponible (Roaming WiFi). Estos modos de seguridad no son compatibles con la funcionalidad Roaming WiFi.\n\nCon el cifrado WEP la funcionalidad WPS quedar&aacute; desactivada en tu router.\n\n\n            ¿Está seguro que desea continuar con el cambio?') == false)
                    return false;

                var checkspc = /(^ |  | $)/;
                var checkhex = /^[\dA-F]{26}$/;
                var checkasc = /^[\x20-\x7e]{13}$/;
                if (checkspc.test(ssidpwd) || (!checkhex.test(ssidpwd) && !checkasc.test(ssidpwd))) {
                    alertSpecial("Tu contrase&ntilde;a WiFi contiene caracteres no v&aacute;lidos. Recuerda que no puedes introducir espacios al inicio o final de la contrase&ntilde;a. Tampoco introducir varios espacios consecutivos.");
                    $('#SSIDPassword,#SSIDPassword1').select().focus();
                    return false;
                }

                var pwd = encodeURIComponent(mess_userpass($('#SSIDPassword,#SSIDPassword1').val()));
                switch (keyIdx) {
                    case '1':
                        loc += '&wlKeyIndex=' + keyIdx + '&wlKey1=' + pwd;
                        break;
                    case '2':
                        loc += '&wlKeyIndex=' + keyIdx + '&wlKey2=' + pwd;
                        break;
                    case '3':
                        loc += '&wlKeyIndex=' + keyIdx + '&wlKey3=' + pwd;
                        break;
                    case '4':
                        loc += '&wlKeyIndex=' + keyIdx + '&wlKey4=' + pwd;
                        break;
                }
            } else if (($('[name=AuthType],[name=AuthType1]').val() == '34') ||
                ($('[name=AuthType],[name=AuthType1]').val() == '44')) {
                var ssidpwd = $('#SSIDPassword,#SSIDPassword1').val();
                if (ssidpwd.length < 8 || ssidpwd.length > 63) {
                    alertSpecial("Longitud clave WiFi incorrecta. Debe contener entre 8 y 63 caracteres.");
                    $('#SSIDPassword,#SSIDPassword1').select().focus();
                    return false;
                } else if (ssidpwd.length < 15) {
                    if (confirmSpecial('Para evitar riesgos de seguridad se recomienda que la longitud minima de la contraseña sea 15 caracteres.') == false)
                        return false;
                }

                var checkspc = /(^ |  | $)/;
                if (checkspc.test(ssidpwd)) {
                    alertSpecial("Tu contrase&ntilde;a WiFi contiene caracteres no v&aacute;lidos. Recuerda que no puedes introducir espacios al inicio o final de la contrase&ntilde;a. Tampoco introducir varios espacios consecutivos.");
                    $('#SSIDPassword,#SSIDPassword1').select().focus();
                    return false;
                }

                var checkasc = /^[\x20-\x7e]{8,63}$/;
                if (!checkasc.test(ssidpwd)) {
                    var chkResult = "";
                    var ascPatrn = /[\x20-\x7e]/;
                    for (var i = 0; i < ssidpwd.length; i++) {
                        var chr = ssidpwd.charAt(i);
                        chkResult += ascPatrn.test(chr) ? "_" : chr;
                    }
                    alertSpecial("El car&aacute;cter introducido " + chkResult + " no es v&aacute;lido para establecer tu clave WiFi.");
                    $('#SSIDPassword,#SSIDPassword1').select().focus();
                    return false;
                }

                if ($('[name=AuthType],[name=AuthType1]').val() == '44')
                    if (confirmSpecial('Aviso: Los modos de seguridad WiFi WEP o mixto WPA/WPA2 no son seguros, le recomendamos utilizar WPA2. Además, si cambias los modos de seguridad en 2.4GHz a mixto WPA/WPA2 o WEP, la WiFi no tendrá la selección automática de tu mejor red WiFi disponible (Roaming WiFi). Estos modos de seguridad no son compatibles con la funcionalidad Roaming WiFi.\n\n            ¿Está seguro que desea continuar con el cambio?') == false)
                        return false;

                loc += '&wlWpaPsk=' + encodeURIComponent(mess_userpass($('#SSIDPassword,#SSIDPassword1').val()));
            }

            loc += '&wlEnbl=' + $('[name=wifiActive]:checked,[name=wifiActive1]:checked').val();
            if ($('[name=wlChannel]').val() == '-1') {
                alertSpecial('Para seleccionar otro canal WiFi, ve a la página de configuración avanzada del router');
                return false;
            }
            loc += '&wlChannel=' + $('[name=wlChannel]').val();
            loc += '&wlSyncNvram=1';
            if ($('.active').attr('src') == 'te_off.png')
                loc += '&wlFltMacMode=0';
            else if ($('.active').attr('src') == 'te_on.png')
                loc += '&wlFltMacMode=1';
            var rowCount = $('#ActiveMAC tr, #ActiveMAC1 tr').length;
            if (rowCount > MAX_MAC_FLT + 1) {
                rowCount = MAX_MAC_FLT + 1;
                alertSpecial('Ya has introducido el n&uacute;mero m&aacute;ximo de direcciones MAC. Para introducir una nueva direcci&oacute;n MAC debes borrar alguna entrada de la tabla.');
                return false;
            }
            loc += '&wlFltMacList=';
            for (i = rowCount - 1; i > 0; i--) {
                mac = $('#ActiveMAC tr, #ActiveMAC1 tr').eq(i).children('td').eq(1).text();
                loc += mac;
                if (i > 1) loc += ",";
            }
            loc += '&unitNum=' + unitNum;
            loc += '&sessionKey=' + sessionKey;
            loc += '&curWebPage=' + curWebPage;
            var code = 'location="' + loc + '"';
            //alertSpecial(code);
            //location.reload();
            eval(code);
        });

        $('[value=' + htmlDecode("A&ntilde;adir") + ']').on('click', function() {
            if (ismobile) {
                if (!checkMac(document.getElementsByName("MACAddress1")[0]))
                    return false;
            } else {
                if (!checkMac(document.getElementsByName("MACAddress")[0]))
                    return false;
            }
            if ($('#ActiveMAC tr, #ActiveMAC1 tr').length < MAX_MAC_FLT) {
                for (var i = 1; i < $('#ActiveMAC tr, #ActiveMAC1 tr').length; i++) {
                    if ($('#ActiveMAC tr, #ActiveMAC1 tr').eq(i).children('td').eq(1).text().toUpperCase() === $('[name=MACAddress],[name=MACAddress1]').val().toUpperCase()) {
                        alertSpecial("No es posible introducir direcciones MAC iguales");
                        return false;
                    }
                }
            }
            if ($('#ActiveMAC tr, #ActiveMAC1 tr').length > MAX_MAC_FLT) {
                alertSpecial('Ya has introducido el n&uacute;mero m&aacute;ximo de direcciones MAC. Para introducir una nueva direcci&oacute;n MAC debes borrar alguna entrada de la tabla.');
                return;
            }
            addRow();
            $('[name=MACAddress],[name=MACAddress1]').val('');
            /*var loc = '/cgi-bin/te_wifi.cmd?action=add&wlMACaddr='+$('[name=MACAddress],[name=MACAddress1]').val();
            loc += '&unitNum='+unitNum;
            loc += '&sessionKey='+sessionKey;
                loc += '&curWebPage='+curWebPage;
            var code = 'location="' + loc + '"';
            //alertSpecial(code);
            //location.reload();
            eval(code); */
        });
        $('.active').on('click', function() {
            if ($(this).attr('src') == 'te_on.png') {
                //$(this).fadeOut(function(){
                $(this).prop('src', 'te_off.png');
                //});
            } else {
                //$(this).fadeOut(function(){
                $(this).prop('src', 'te_on.png');
                //});
            }
        });
        $('.delall').on('click', function() {
            $('#ActiveMAC, #ActiveMAC1').find('tr:not(:first)').remove();
        });
        $('[name=MACAddress]').keypress(function(e) {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13) {
                if (ismobile) {
                    if (!checkMac(document.getElementsByName("MACAddress1")[0]))
                        return false;
                } else {
                    if (!checkMac(document.getElementsByName("MACAddress")[0]))
                        return false;
                }
                if ($('#ActiveMAC tr, #ActiveMAC1 tr').length < MAX_MAC_FLT) {
                    for (var i = 1; i < $('#ActiveMAC tr, #ActiveMAC1 tr').length; i++) {
                        if ($('#ActiveMAC tr, #ActiveMAC1 tr').eq(i).children('td').eq(1).text() == $('[name=MACAddress],[name=MACAddress1]').val()) {
                            alertSpecial("No es posible introducir direcciones MAC iguales");
                            return false;
                        }
                    }
                }
                if ($('#ActiveMAC tr, #ActiveMAC1 tr').length > MAX_MAC_FLT) {
                    alertSpecial('MAX ' + MAX_MAC_FLT + ' entradas!');
                    return;
                }
                addRow();
                $('[name=MACAddress],[name=MACAddress1]').val('');
            }
        });
    });

    function utf16to8(str) {
        var out, i, len, c;
        out = "";
        len = str.length;
        for (i = 0; i < len; i++) {
            c = str.charCodeAt(i);
            if ((c >= 0x0001) && (c <= 0x007F)) {
                out += str.charAt(i);
            } else if (c > 0x07FF) {
                out += String.fromCharCode(0xE0 | ((c >> 12) & 0x0F));
                out += String.fromCharCode(0x80 | ((c >> 6) & 0x3F));
                out += String.fromCharCode(0x80 | ((c >> 0) & 0x3F));
            } else {
                out += String.fromCharCode(0xC0 | ((c >> 6) & 0x1F));
                out += String.fromCharCode(0x80 | ((c >> 0) & 0x3F));
            }
        }
        return out;
    }

    function checkPassLevel(auth, pass) { //#10650
        if (auth == '00') return 0;

        var digitPatrn = /\d/;
        var letterPatrn = /[a-z]/i;
        var specialPatrn = /\W/;
        var checkspc = /(^ |  | $)/;
        var hexPatrn = /^[\dA-F]{26}$/;
        var wepPatrn = /^[\x20-\x7e]{13}$/;
        var wpaPatrn = /^[\x20-\x7e]{8,63}$/;
        var ret = 0;

        if (auth == '02') {
            if (pass.length > 26) {
                alertSpecial("Longitud de clave incorrecta. Recuerda que puedes introducir 13 caracteres en codificaci&oacute;n ASCII (letras, n&uacutemeros y caracteres especiales) o bien 26 caracteres en codificaci&oacute;n Hexadecimal (0-9 y A-F).");
                pass = pass.substr(0, 26);
                $('#SSIDPassword,#SSIDPassword1').val(pass);
                $('#SSIDPassword,#SSIDPassword1').select().focus();
            }
            if ((wepPatrn.test(pass) || hexPatrn.test(pass)) && !checkspc.test(pass)) {
                ret = digitPatrn.test(pass) + letterPatrn.test(pass) + specialPatrn.test(pass);
                if (hexPatrn.test(pass) || (ret > 2)) ret = 2;
            }
        } else {
            if (pass.length > 63) {
                alertSpecial("Longitud clave WiFi incorrecta. Debe contener entre 8 y 63 caracteres.");
                pass = pass.substr(0, 63);
                $('#SSIDPassword,#SSIDPassword1').val(pass);
                $('#SSIDPassword,#SSIDPassword1').select().focus();
            }
            if (wpaPatrn.test(pass) && !checkspc.test(pass)) {
                ret = digitPatrn.test(pass) + letterPatrn.test(pass) + specialPatrn.test(pass);
                if ((pass.length <= 10) && (ret > 2)) ret = 2;
            }
        }

        return ret;
    }

    function showPassLevel(passlevel) {
        if (passlevel == 0) {
            $('#security,#security1').find('img').attr("src", "te_nopass.jpg");
        } else if (passlevel == 1) {
            $('#security,#security1').find('img').attr("src", "te_low.jpg");
        } else if (passlevel == 2) {
            $('#security,#security1').find('img').attr("src", "te_media.jpg");
        } else {
            $('#security,#security1').find('img').attr("src", "te_high.jpg");
        }
    }

    function showtable(obj) {
        var macFlt = wifiMacFlt.split(',');
        for (var i = 0; i < macFlt.length; i++) {
            if (macFlt[i] != '') {
                $('#' + obj + ' tr:last').after('<tr>\
                <td align="center"><img class="hand" src="te_cross.png" onclick="deleteRow(this);"></td>\
                <td>' + macFlt[i] + '</td>\
                <td align="center"><img class="hand" src="te_edit.png" onclick="editRow(this);"></td>\
              </tr>');
            }
        }
    }

    function addRow() {
        $("#ActiveMAC tr:last, #ActiveMAC1 tr:last").after('<tr>\
            <td align="center"><img class="hand" src="te_cross.png" onclick="deleteRow(this);"></td>\
            <td>' + $("[name=MACAddress],[name=MACAddress1]").val().toUpperCase() + '</td>\
            <td align="center"><img class="hand" src="te_edit.png" onclick="editRow(this);"></td>\
          </tr>');
    }

    function editRow(obj) {
        if (oldIE) {
            alertSpecial('Funci&oacute;n de edici&oacute;n no es compatible con la versi&oacute;n anterior antes de IE10.');
            return;
        }

        var mac = $(obj).closest("tr").children("td").eq(1).text();
        swal({
                title: "Direcci&oacute;n MAC",
                text: "<br/><br/>Nueva direcci&oacute;n MAC:<br/>",
                type: "input",
                customClass: "sweet-alert1",
                showCancelButton: true,
                cancelButtonText: "Cancelar",
                animation: "slide-from-bottom",
                html: true,
                inputValue: mac
            },
            function(inputValue) {
                if (inputValue === false) return false;
                inputValue = inputValue.toUpperCase();
                if (!isMacAddr(inputValue) || inputValue == "00:00:00:00:00:00") {
                    alertSpecial("Direcci&oacute;n MAC no v&aacute;lida. Debe ser un n&uacute;mero hexadecimal (0-9 ?A-F). Ej. XX:XX:XX:XX:XX:XX");
                    return false;
                }
                if (inputValue != mac) {
                    if ($('#ActiveMAC tr, #ActiveMAC1 tr').length < MAX_MAC_FLT) {
                        for (var i = 1; i < $('#ActiveMAC tr, #ActiveMAC1 tr').length; i++) {
                            if ($('#ActiveMAC tr, #ActiveMAC1 tr').eq(i).children('td').eq(1).text() == inputValue) {
                                alertSpecial("No es posible introducir direcciones MAC iguales");
                                return false;
                            }
                        }
                    }
                }
                $(obj).closest("tr").children("td").eq(1).text(inputValue);
            });
    }

    function deleteRow(obj) {
        $(obj).closest("tr").remove(); //remove row
    }

    function editTable(obj) {
        $('.edit').addClass('divHide');
        $('.save').removeClass('divHide');

        var macFlt = wifiMacFlt.split(',');
        for (i = 1; i <= macFlt.length; i++) {
            if (macFlt[i - 1][0] == '-') macFlt[i - 1] = macFlt[i - 1].substring(1);
            $('#' + obj + ' tr').eq(i).children('td').eq(0).removeClass('divHide');
            $('#' + obj + ' tr').eq(i).children('td').eq(1).remove();
            $('#' + obj + ' tr').eq(i).children('td').eq(1).html('<input type="text" value="' + macFlt[i - 1] + '">');
            $('#' + obj + ' tr').eq(i).children('td').eq(2).find('img').attr("onclick", "activeMAC(this);");
            $('#' + obj + ' tr').eq(i).children('td').eq(2).find('img').attr("class", "hand");
        }
    }

    function saveTable(obj) {
        $('.edit').removeClass('divHide');
        $('.save').addClass('divHide');
        var rowCount = $('#' + obj + ' tr').length;
        var loc = '/cgi-bin/te_wifi.cmd?action=save&wlMACaddr='; //wlMACaddr format to server "MAC1,-MAC2,...."
        if (rowCount > MAX_MAC_FLT + 1) {
            rowCount = MAX_MAC_FLT + 1;
            alertSpecial('Demasiadas entradas! Las primeras ' + MAX_MAC_FLT + ' entradas.');
        }
        for (i = rowCount - 1; i > 0; i--) {
            if ($('#' + obj + ' tr').eq(i).children('td').eq(2).find('img').attr('src') == 'te_off.png')
                loc += '-';
            mac = $('#' + obj + ' tr').eq(i).children('td').eq(1).find('input').val();
            loc += mac;
            if (i > 1) loc += ",";
        }
        loc += '&unitNum=' + unitNum;
        loc += '&sessionKey=' + sessionKey;
        loc += '&curWebPage=' + curWebPage;
        var code = 'location="' + loc + '"';
        //alertSpecial(code);
        //location.reload();
        eval(code);
    }

    function activeMAC(obj) {
        if ($(obj).attr('src') == 'te_on.png') {
            $(obj).fadeOut(function() {
                $(obj).attr('src', 'te_off.png').fadeIn(0.00000000001);
            });
        } else {
            $(obj).fadeOut(function() {
                $(obj).attr('src', 'te_on.png').fadeIn(0.00000000001);
            });
        }
    }

    function loadChannelList() {
        var sel_ch;
        var sel_band;
        var sel_nbw_cap;
        var sel_sb;
        var idx;

        /* save selected */
        sel_ch = channel;
        sel_band = band;
        sel_nbw_cap = nbwcap;
        sel_sb = nctrlsb;

        /* load list */
        document.forms[0].wlChannel.length = 0;
        document.forms[0].wlChannel[0] = new Option("Other Fixed", "-1");
document.forms[0].wlChannel[1] = new Option("Auto", "0");
document.forms[0].wlChannel[2] = new Option("1", "1");
document.forms[0].wlChannel[3] = new Option("6", "6");
document.forms[0].wlChannel[4] = new Option("11", "11");


        /* mark selected */
        for (idx = 0; idx < document.forms[0].wlChannel.options.length; idx++) {
            if (document.forms[0].wlChannel.options[idx].value == sel_ch) {
                document.forms[0].wlChannel.options[idx].selected = true;
                break;
            }
        }
        document.forms[0].wlChannel.options[0].text = 'Otro Fijo';
        document.forms[0].wlChannel.options[1].text = 'Auto';
    }

    function passwordFocus(obj) {
       $(obj).attr("readOnly", false);
       $(obj).prop("readOnly", false);
    }

    function passwordBlur(obj) {
       $(obj).attr("readOnly", true);
       $(obj).prop("readOnly", true);
    }
    // done hiding -->
    </script>
</head>

<body>
    <div id="PCformat">
        <div id="includeHeader"></div>
        <div class="Body"></div>
        <div class="Body2">
            <div class="title">WiFi</div>
            <div class="content" style="height:680px;">
                <div class="littletitle">WiFi</div>
                <p class="content_word">Desde aqu&iacute; podr&aacute;s configurar tu red inal&aacute;mbrica. Escaneando el c&oacute;digo QR puedes incluso conectar tus equipos directamente. Tambi&eacute;n puedes a&ntilde;adir las direcciones MAC de los equipos que puedan acceder a tu WiFi.</p>
                <table class="editItems" border="0" style="width:100%">
                    <tr>
                        <td class="titlesize">Nombre WiFi:</td>
					<td><input class="Input_box" type="text" name="SSIDName" size="32"></td>
                    </tr>
                    <tr>
                        <td class="titlesize">Ocultar Nombre WiFi:</td>
                        <td>
                            <input type="radio" name="hideSSID" value="1">Si
                            <input type="radio" name="hideSSID" value="0">No
                        </td>
                    </tr>
                    <tr class="pwdfield">
					<td class="titlesize" style="text-indent:0px;padding-left:20px;">Clave WiFi: Introduce letras, n&uacute;meros y caracteres especiales (@,&,!,+, etc) para que tu clave WiFi tenga seguridad alta</td>
					<td><input class="Input_box" type="password" id="SSIDPassword" size="32" readOnly onmouseover="passwordFocus(this)" onfocus="passwordFocus(this)" onblur="passwordBlur(this)" autocomplete="off" size="32"><img class="hand" src="show.gif"></td>
                        <td id="security" style="width:250px;">Nivel de seguridad de la contrase&ntilde;a<img style="margin-left:10%;" src="te_nopass.jpg"></td>
                    </tr>
                    <tr>
                        <td class="titlesize">Estado Red Inal&aacute;mbrica:</td>
                        <td>
                            <input type="radio" name="wifiActive" value="1">Activado
                            <input type="radio" name="wifiActive" value="0">Desactivado
                        </td>
                    </tr>
				<tr><td></td><td></td><td></td></tr>
                </table>
                <div style="margin-left:2%;"><img style="height:50px;" src="te_quotation.png"></div>
				<div style="margin-top:-50px;margin-left:75px;"><b>Aviso:</b> El m&eacute;todo de cifrado WEP no es compatible con WPS (2.0). Si lo seleccionas la funcionalidad WPS quedar&aacute; desactivada en tu router.</div><br>
                <table class="editItems" border="0" style="width:100%">
                    <tr>
                        <td class="titlesize">Seguridad:</td>
                        <td>
                            <select class="Select_box" name="AuthType">
                                <option value="00">Sin cifrado</option>
                                <option value="02">WEP</option>
                                <option value="34">WPA2(AES)</option>
                                <option value="44">WPA/WPA2 Mixto</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class="titlesize">N&uacute;mero canal WiFi:</td>
                        <td>
                            <form>
					<select class="Select_box" name="wlChannel">
                                </select>
                            </form>
                        </td>
                    </tr>
                    <tr>
					<td class="titlesize">Canal actual:</td><td name="currentChannel"></td>
                    </tr>
                    <tr>
                        <td style="text-indent:0px;padding-left:20px;" colspan="2">Escanea este c&oacute;digo y guarda los datos de tu configuraci&oacute;n inal&aacute;mbrica en tu m&oacute;vil. Adem&aacute;s, si tu aplicaci&oacute;n de escaneo lo permite, podr&aacute;s compartirlo con tus amigos e incluso conectarte directamente</td>
                        <td class="code"></td>
                    </tr>
                    <tr>
                        <td><input type="button" value="Aplicar cambios"></td>
                    </tr>
                </table>
            </div>
            <div class="title">WPS</div>
            <div class="content">
                <div class="littletitle">WPS</div>
				<div class="content_word">Para habilitar la ventana WPS pulsa el bot&oacute;n f&iacute;sico de tu equipo dedicado a esta funcionalidad. <br><b>Aviso:</b> El metodo de cifrado WEP no es compatible con WPS2.0. Para m&aacute;s informaci&oacute;n consulta la opci&oacute;n de <a href="te_ayuda_configurador_web.asp#wps">Ayuda</a></div>
            </div>
            <div class="title">Filtrado MAC</div>
            <div class="content">
                <div class="littletitle">Filtrado MAC</div>
				<div class="content_word">Para una sencilla y rápida definición de filtrado MAC,hemos creado una aplicación que puedes descargarte en la tienda de aplicaciones de tu smarthphone.</div>
            </div>
        </div>
    </div>
    <div id="mobileformat">
        <div id="includeHeader"></div>
		<div class="MBody"></div>
        <div class="MBody2">
            <div class="Mtitle">WiFi</div>
            <div class="Mcontent">
                <div class="littletitle">WiFi</div>
				<p class="Mcontent_word">Desde aqu&iacute; podr&aacute;s configurar tu red inal&aacute;mbrica. Escaneando el c&oacute;digo QR puedes incluso conectar tus equipos directamente. Tambi&eacute;n puedes a&ntilde;adir las direcciones MAC de los equipos que puedan acceder a tu WiFi.</p>
                <div class="Mtitlesize">Nombre WiFi:</div>
				<div><input class="MInput_box" type="text" name="SSIDName1"></div>
                <div>
                    <span class="Mtitlesize">Ocultar Nombre WiFi:</span>
                    <input type="radio" name="hideSSID1" value="1">Si
                    <input type="radio" name="hideSSID1" value="0">No
                </div>
                <div class="pwdfield">
                    <div class="Mtitlesize">Clave WiFi: Introduce letras, n&uacute;meros y caracteres especiales (@,&,!,+, etc) para que tu clave WiFi tenga seguridad alta</div>
				<div><input class="MInput_box" type="password" id="SSIDPassword1" readOnly onmouseover="passwordFocus(this)" onfocus="passwordFocus(this)" onblur="passwordBlur(this)" autocomplete="off" size="32"><img class="hand" src="show.gif"></div>
                    <div style="text-align:center;">Nivel de seguridad de la contrase&ntilde;a</div>
                    <div id="security1"><img style="width:200px;height:16px;display:block;margin:auto;" src="te_nopass.jpg"></div>
                </div>
                <div>
                    <span class="Mtitlesize">Estado Red Inal&aacute;mbrica:</span>
                    <input type="radio" name="wifiActive1" value="1">Activado
                    <input type="radio" name="wifiActive1" value="0">Desactivado
                </div>
				<p class="Mcontent_word">Escanea este c&oacute;digo y guarda los datos de tu configuraci&oacute;n inal&aacute;mbrica en tu m&oacute;vil. Adem&aacute;s, si tu aplicaci&oacute;n de escaneo lo permite, podr&aacute;s compartirlo con tus amigos e incluso conectarte directamente</p>
                <div style="text-align:center;"><span class="code"></span></div>
                <p>
                    <img style="width:50px;height:50px;" src="te_quotation.png">
                    <div style="margin-top:-75px;margin-left:75px;"><b>Aviso:</b> El m&eacute;todo de cifrado WEP no es compatible con WPS (2.0). Si lo seleccionas la funcionalidad WPS quedar&aacute; desactivada en tu router.</div>
                </p>
                <div class="Mtitlesize">Seguridad</div>
                <div>
                    <select class="MSelect_box" name="AuthType1">
                        <option value="00">Sin cifrado</option>
                        <option value="02">WEP</option>
                        <option value="34">WPA2(AES)</option>
                        <option value="44">WPA/WPA2 Mixto</option>
                    </select>
                </div>
                <div class="Mtitlesize">N&uacute;mero canal WiFi</div>
                <div>
                    <form>
                        <select class="MSelect_box" name="wlChannel">
                        </select>
                    </form>
                </div>
                <span class="Mtitlesize">Canal actual</span>:<span name="currentChannel1"></span>
                <div><input type="button" value="Aplicar cambios"></div>
            </div>
            <div class="Mtitle">WPS</div>
            <div class="Mcontent">
                <div class="littletitle">WPS</div>
				<div class="Mcontent_word">Para habilitar la ventana WPS pulsa el bot&oacute;n f&iacute;sico de tu equipo dedicado a esta funcionalidad.<br><b>Aviso:</b> El metodo de cifrado WEP no es compatible con WPS2.0. Para m&aacute;s informaci&oacute;n consulta la opci&oacute;n de <a href="te_ayuda_configurador_web.asp#wps">Ayuda</a></div>
            </div>
            <div class="Mtitle">Filtrado MAC</div>
			<div class="Mcontent">
                <div class="littletitle">Filtrado MAC</div>
				<div class="Mcontent_word">Para una sencilla y rápida definición de filtrado MAC,hemos creado una aplicación que puedes descargarte en la tienda de aplicaciones de tu smarthphone.</div>
			</div><br>
        </div>
    </div>
</body>
</html>
